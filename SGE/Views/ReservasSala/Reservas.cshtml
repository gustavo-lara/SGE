@model IEnumerable<SGE.Models.ReservaSala>
@using System.Globalization
@{
    var years = Enumerable.Range(DateTime.Now.Year, 5);
    var months = Enumerable.Range(1, 12);
    List<Sala> ListaSalas = (List<Sala>)ViewData["Salas"];
    List<ReservaSala> ListaReservas = (List<ReservaSala>)ViewData["ReservasSala"];

}

<div>
    <div class="d-flex row justify-content-between my-5">
        <div style="width: 15%;">
            <img src="https://placehold.co/200x150" />
        </div>
        <div style="width: 85%;" class="ps-5">
            <div class="d-flex row align-items-center justify-content-between">
                <h1 style="width:18%; font-size:3.2rem; color:#F6D524;">Salas</h1>
                <div style="height:5px; width:82%; background:#F6D524;" />
            </div>
            <p style="font-size:1.5rem; color:#fff;">Administre as reservas de salas.</p>
        </div>
    </div>

    <div class="tableAlunosTop">
        <h3>Salas Cadastradas</h3>
        <div style="display:flex; align-items:center; justify-content:center; gap:3em;">
            <a asp-action="Create">
                <svg width="35" height="35" viewBox="0 0 45 45" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_166_1154)">
                        <path d="M39.375 2.8125C40.1209 2.8125 40.8363 3.10882 41.3637 3.63626C41.8912 4.16371 42.1875 4.87908 42.1875 5.625V39.375C42.1875 40.1209 41.8912 40.8363 41.3637 41.3637C40.8363 41.8912 40.1209 42.1875 39.375 42.1875H5.625C4.87908 42.1875 4.16371 41.8912 3.63626 41.3637C3.10882 40.8363 2.8125 40.1209 2.8125 39.375V5.625C2.8125 4.87908 3.10882 4.16371 3.63626 3.63626C4.16371 3.10882 4.87908 2.8125 5.625 2.8125H39.375ZM5.625 0C4.13316 0 2.70242 0.592632 1.64752 1.64752C0.592632 2.70242 0 4.13316 0 5.625L0 39.375C0 40.8668 0.592632 42.2976 1.64752 43.3525C2.70242 44.4074 4.13316 45 5.625 45H39.375C40.8668 45 42.2976 44.4074 43.3525 43.3525C44.4074 42.2976 45 40.8668 45 39.375V5.625C45 4.13316 44.4074 2.70242 43.3525 1.64752C42.2976 0.592632 40.8668 0 39.375 0L5.625 0Z" fill="white" />
                        <path d="M22.5 11.25C22.873 11.25 23.2306 11.3982 23.4944 11.6619C23.7581 11.9256 23.9062 12.2833 23.9062 12.6562V21.0938H32.3438C32.7167 21.0938 33.0744 21.2419 33.3381 21.5056C33.6018 21.7694 33.75 22.127 33.75 22.5C33.75 22.873 33.6018 23.2306 33.3381 23.4944C33.0744 23.7581 32.7167 23.9062 32.3438 23.9062H23.9062V32.3438C23.9062 32.7167 23.7581 33.0744 23.4944 33.3381C23.2306 33.6018 22.873 33.75 22.5 33.75C22.127 33.75 21.7694 33.6018 21.5056 33.3381C21.2419 33.0744 21.0938 32.7167 21.0938 32.3438V23.9062H12.6562C12.2833 23.9062 11.9256 23.7581 11.6619 23.4944C11.3982 23.2306 11.25 22.873 11.25 22.5C11.25 22.127 11.3982 21.7694 11.6619 21.5056C11.9256 21.2419 12.2833 21.0938 12.6562 21.0938H21.0938V12.6562C21.0938 12.2833 21.2419 11.9256 21.5056 11.6619C21.7694 11.3982 22.127 11.25 22.5 11.25Z" fill="white" />
                    </g>
                    <defs>
                        <clipPath id="clip0_166_1154">
                            <rect width="45" height="45" fill="white" />
                        </clipPath>
                    </defs>
                </svg>
            </a>
            <h3>|</h3>
            <input style="width:40em; height: 2.5em; background:none; border: 1px solid white; border-radius:15px; padding:0px 10px; color:white;" type="search" placeholder="Pesquisar turma" />
        </div>
    </div>
</div>

<div class="container">

    <h1 class="text-center">Reservas de Salas</h1>
    <p>
        <a asp-controller="Salas" asp-action="Create">Criar Sala</a>
    </p>


    @if (ViewData["Erro"] != null)
    {
        <div class="row">
            <div class="col-md-4 text-center">
                <div class="alert alert-danger">
                    <strong> @ViewData["Erro"] </strong>
                </div>
            </div>
        </div>
    }
    <div class="row">
        <div class="col-12">
            <form method="post" asp-action="FiltarSalas">
                <div class="input-group mb-1">
                    <input type="text" class="form-control" name="filtro"
                           placeholder="Pesquisar por Sala" aria-label="Pesquisar por Sala"
                           aria-describedby="button-addon2">
                    <button class="btn btn-dark" type="submit" id="button-addon2">
                        <svg bootstrap-icon="Search" width="16" height="16" aria-label="Pesquisar"></svg>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div class="row">
        <div class="col-12 h-25 overflow-auto">
            <table class="table table-sm">
                <thead>
                    <tr>
                        <th>
                            Nome da Sala
                        </th>
                        <th class="text-end">
                            Selecionar
                        </th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in ListaSalas)
                    {
                        <tr>
                            <td>
                                @item.SalaNome
                            </td>
                            <td class="text-end">
                                <a asp-action="SelecionaSala" asp-route-id="@item.SalaId" class="btn btn-primary">Selecionar</a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
    <div class="row text center mt-3 mb-3">
        <div class="col-12 d-flex justify-content-around">

            @if (ViewData["SalaSelecionada"] != null)
            {
                <div class="d-flex justify-content-between" style="width:100%;">
                    <div class="d-flex justify-content-start" style="width:70%;">
                        <h2 style="font-size:2rem; color:#fff;">Reservas da Sala:</h2>
                        <p style="background:none; border: none; border-bottom: 1px solid #fff; color: gray; width:40%" class="ms-3">@ViewData["SalaSelecionada"]</p>
                    </div>
                    <a asp-action="NovaReserva" asp-route-id="@ViewData["IdSalaSelecionada"]" class="btn botaoBranco2" style="width:20%;">Nova Reserva</a>
                </div>
            }
        </div>
    </div>

    @if (ViewData["SalaSelecionada"] != null)
    {
        <div class="row mb-3">
            <div class="col-md-6">
                <select id="month" class="headerTabela textoHeaderTabela">
                    @foreach (var month in months)
                    {
                        <option value="@month">@DateTimeFormatInfo.CurrentInfo.GetMonthName(month)</option>
                    }
                </select>
            </div>
            <div class="col-md-6">
                <select id="year" class="headerTabela textoHeaderTabela">
                    @foreach (var year in years)
                    {
                        <option value="@year">@year</option>
                    }
                </select>
            </div>
        </div>

        <div id="calendar" class="">
            <div id="calendar-header">
                <div id="calendar-month-year">
                    <span id="calendar-month"></span>
                    <span id="calendar-year"></span>
                </div>
            </div>
            <div id="calendar-body">
                <table class="tabelaCalendario" style="width:100%;">
                    <thead id="calendar-weekdays">
                        <tr>
                            <td class="text-center">Dom</td>
                            <td class="text-center">Seg</td>
                            <td class="text-center">Ter</td>
                            <td class="text-center">Qua</td>
                            <td class="text-center">Qui</td>
                            <td class="text-center">Sex</td>
                            <td class="text-center">Sab</td>
                        </tr>
                    </thead>
                    <tbody id="calendar-days">
                    </tbody>
                </table>
            </div>
        </div>

        <div id="modal" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data - dismiss="modal" aria - label="Close"> <span aria - hidden="true">& times; </span></button>
                        <h4 class="modal-title">
                            Selected Date < /h4>
                            < /div>
                            < div class="modal-body" >
                            <p>Selected date: </p>
                            < /div>
                            < div class="modal-footer" >
                            <button type="button" class="btn btn-default" data - dismiss="modal">
                                Close
                            </button>
                    </div>
                </div>
            </div>
        </div>
    }
    @if (ListaReservas != null)
    {
        <div id="idReservasSala" class="d-none">
            <table class="table" id="TabelaReservas">
                @foreach (var item in ListaReservas)
                {
                    <tr>
                        <td class="dataInicio">
                            @item.DataReserva.ToString("yyyy-MM-dd")
                        </td>
                        <td class="dataFim">
                            @item.DataFimReserva.ToString("yyyy-MM-dd")
                        </td>
                        <td class="horaInicio">
                            @item.HoraInicio
                        </td>
                        <td class="horaFim">
                            @item.HoraFim
                        </td>
                        <td class="usuario">
                            @item.Usuario.UsuarioNome
                        </td>
                        <td class="cor">
                            @item.CorReserva
                        </td>
                    </tr>
                }
            </table>
        </div>
    }
</div>

@section scripts {
    <script src="~/js/reservas.js"></script>
}

